<app-header>
</app-header>

<div class="container">
    <ng-container *ngIf="asset$ | async as asset; else loading">
        <ng-container *ngIf="asset['data'] !== null; else noContent">
            <div class="mt-5 pt-5 p-3">
                <app-back-button></app-back-button>
                <app-tabs [asset]=asset></app-tabs>


                <form [formGroup]="reactiveForm" (ngSubmit)="Dialog()">
                    <div class="row pt-3">
                        <mat-accordion class="full-width" [multi]="true">
                            <!--DATOS-->
                            <mat-expansion-panel [expanded]="true">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        Datos Activo fijo
                                    </mat-panel-title>
                                </mat-expansion-panel-header>

                                <div *ngIf="asset['data'].status == 3">
                                    <div class="alert alert-dismissible alert-warning">
                                        <button type="button" class="close" data-dismiss="alert">×</button>
                                        <h4 class="alert-heading"><strong>Atención</strong></h4>
                                        <p class="mb-0 mt-0">Este activo fijo esta dado de baja</p>
                                    </div>
                                </div>

                                <p class="display-5 pr-3 d-sm-block pr-3">Fecha de creación: {{utils.formatDate(asset['data'].createdAt.date)}}
                                </p>
                                <p class="display-5 pr-3 d-sm-block">Número AF: {{ asset['data'].referalCode }}
                                </p>
                                <p class="display-5 pr-3 d-sm-block">Código RFID: {{ asset['data'].rfidLabelSap }}
                                </p>
                                <p class="display-5 pr-3 d-sm-block">Condición:
                                    <span *ngIf="asset['data']?.status == 1" class="badge badge-secondary">En Proceso</span>
                                    <span *ngIf="asset['data']?.status == 2" class="badge badge-primary">Activo</span>
                                    <span *ngIf="asset['data']?.status == 3" class="badge badge-danger">Dado de Baja</span>
                                </p>



                                <!--Clase activo fijo-->
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>Clase activo fijo</mat-label>
                                    <div *ngIf="asset['data'].catalogClass == null; else catalogClass">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #catalogClass>
                                        <input matInput placeholder="" readonly value="{{asset['data'].catalogClass.name}}">
                                    </ng-template>
                                </mat-form-field>
                                <!--Clase activo fijo-->

                                <!--Código Rfid-->
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Código Rfid
                                    </mat-label>
                                    <div *ngIf="asset['data'].rfidLabelSap == null; else rfidLabelSap">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #rfidLabelSap>
                                        <input matInput readonly placeholder="Código Rfid" value="{{asset['data'].rfidLabelSap}}">
                                    </ng-template>
                                </mat-form-field>
                                <!--Código Rfid-->






                                <!--Sociedad-->
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Sociedad
                                    </mat-label>
                                    <div *ngIf="asset['data'].society == null; else society">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #society>
                                        <input matInput placeholder="" readonly value="{{asset['data'].society}}">
                                    </ng-template>
                                </mat-form-field>
                                <!--Sociedad-->


                                <!--Fecha de Capitalización-->

                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Fecha de Capitalización
                                    </mat-label>
                                    <div *ngIf="asset['data'].capitalizationDateAt == null; else capitalizationDateAt">

                                        <input matInput placeholder="" readonly disabled value="Sin datos">

                                    </div>
                                    <ng-template #capitalizationDateAt>
                                        <input matInput placeholder="" readonly value="{{utils.formatDate(asset['data'].capitalizationDateAt.date)}}">
                                    </ng-template>
                                </mat-form-field>
                                <!--Fecha de Capitalización-->
                            </mat-expansion-panel>
                            <!--ESPECIE-->
                            <mat-expansion-panel>
                                <mat-expansion-panel-header>
                                    <mat-panel-title class="text-primary">
                                        Especie
                                    </mat-panel-title>
                                </mat-expansion-panel-header>

                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Especie
                                    </mat-label>
                                    <div *ngIf="asset['data'].specie == null; else specie">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #specie>
                                        <input matInput placeholder="Especie" readonly value="{{asset['data'].specie.code}}-{{asset['data'].specie.name}}">
                                    </ng-template>
                                </mat-form-field>



                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label class="text-primary">
                                        Número de serie
                                        <mat-icon aria-hidden="false" class="text-primary">edit</mat-icon>
                                    </mat-label>



                                    <input matInput placeholder="Número de serie" formControlName="serieNumber" [readonly]="false" value="asset.serieNumber">
                                    <small class="text-info" *ngIf="reactiveForm.get('serieNumber').hasError('required')">Campo
                                requerido</small>

                                </mat-form-field>



                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label class="text-primary">
                                        Descripción
                                        <mat-icon aria-hidden="false" class="text-primary">edit</mat-icon>
                                    </mat-label>
                                    <textarea matInput [readonly]="false" formControlName="description" cols="5">{{asset['data'].description}}</textarea>

                                </mat-form-field>

                                <mat-checkbox [checked]="true" [disabled]="true">Incluir activo fijo en lista inventario
                                </mat-checkbox>
                                <br/>
                                <mat-checkbox [checked]="true" [disabled]="true">Gestión histórica</mat-checkbox>
                            </mat-expansion-panel>
                            <!--CENTRO DE COSTO-->
                            <mat-expansion-panel>
                                <mat-expansion-panel-header>
                                    <mat-panel-title class="text-primary">
                                        Centro de costo
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label class="text-primary">Centro de costo
                                        <mat-icon aria-hidden="false" class="text-primary">edit</mat-icon>
                                    </mat-label>
                                    <select matNativeControl formControlName="costCenter">
                                        <option [ngValue]="null" disabled>Seleccione ...</option>
                                        <option *ngFor="let ccenter of ccenters" [value]="ccenter.id">
                                            {{ccenter.code}}-{{ccenter.name}}</option>
                                    </select>

                                </mat-form-field>
                            </mat-expansion-panel>
                            <!--ASIGNACIONES-->
                            <mat-expansion-panel>
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        Asignaciones
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Centro
                                    </mat-label>
                                    <div *ngIf="asset['data'].lCenter == null; else lCenter">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #lCenter>
                                        <input matInput placeholder="Centro" readonly value="{{asset['data'].lCenter.code}} - {{asset['data'].lCenter.name}}">
                                    </ng-template>
                                </mat-form-field>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Edificio
                                    </mat-label>
                                    <div *ngIf="asset['data'].lBuilding.code == null; else lBuilding">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #lBuilding>
                                        <input matInput placeholder="Edificio" readonly value="{{asset['data'].lBuilding.code}} - {{asset['data'].lBuilding.name}}">
                                    </ng-template>
                                </mat-form-field>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Piso
                                    </mat-label>
                                    <div *ngIf="asset['data'].lFloor == null; else lFloor">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #lFloor>
                                        <input matInput placeholder="Piso" readonly value="{{asset['data'].lFloor.code}} - {{asset['data'].lFloor.name}}">
                                    </ng-template>
                                </mat-form-field>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Área
                                    </mat-label>
                                    <div *ngIf="asset['data'].lArea == null; else lArea">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #lArea>
                                        <input matInput placeholder="Área" readonly value="{{asset['data'].lArea.code}} - {{asset['data'].lArea.name}}">
                                    </ng-template>
                                </mat-form-field>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Sala
                                    </mat-label>
                                    <div *ngIf="asset['data'].lRoom == null; else lRoom">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #lRoom>
                                        <input matInput placeholder="Sala" readonly value="{{asset['data'].lRoom.code}} - {{asset['data'].lRoom.name}}">
                                    </ng-template>
                                </mat-form-field>

                            </mat-expansion-panel>
                            <!--ORIGEN-->
                            <mat-expansion-panel>
                                <mat-expansion-panel-header>
                                    <mat-panel-title class="text-primary">
                                        Origen
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label class="text-primary">
                                        ID Acreedor
                                        <mat-icon aria-hidden="false" class="text-primary">edit</mat-icon>
                                    </mat-label>
                                    <input matInput formControlName="creditorId" placeholder="ID Acreedor" value="{{asset['data'].creditorId}}">
                                    <small class="text-info" *ngIf="reactiveForm.get('creditorId').hasError('required')">Campo
                                        requerido</small>
                                </mat-form-field>
                                <mat-checkbox [checked]="true" [disabled]="true">¿Es un activo nuevo?</mat-checkbox>
                            </mat-expansion-panel>
                            <!--AGNOS ESPERANZA-->
                            <mat-expansion-panel>
                                <mat-expansion-panel-header>
                                    <mat-panel-title class="text-primary">
                                        Años de vida útil
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label class="text-primary">
                                        Años de vida útil
                                        <mat-icon aria-hidden="false" class="text-primary">edit</mat-icon>
                                    </mat-label>
                                    <input matInput placeholder="Años de vida útil" formControlName="lifetimeYear" value="{{asset.lifetimeYear}}">
                                    <small class="text-info" *ngIf="reactiveForm.get('lifetimeYear').hasError('required')">Campo
                                        requerido</small>
                                </mat-form-field>
                                <mat-form-field appearance="outline" class="full-width">
                                    <mat-label>
                                        Vida útil tributaria
                                    </mat-label>
                                    <div *ngIf="asset['data'].lifetimeYear15 == null; else lifetimeYear15">
                                        <input matInput placeholder="" readonly disabled value="Sin datos">
                                    </div>
                                    <ng-template #lifetimeYear15>
                                        <input matInput placeholder="Vida útil tributaria" readonly value="{{asset['data'].lifetimeYear15}}">
                                    </ng-template>
                                </mat-form-field>
                            </mat-expansion-panel>
                        </mat-accordion>



                    </div>
                    <div class="row mt-3 mb-5">
                        <button type="submit" [disabled]="reactiveForm.invalid" class="btn btn-lg btn-primary full-width mb-3">Guardar cambios y enviar</button>
                    </div>
                </form>


            </div>
        </ng-container>
    </ng-container>
    <ng-template #loading>
        <mat-spinner></mat-spinner>
    </ng-template>
    <ng-template #noContent>
        <h1 class="text-danger">
            {{utils.toHome()}}
        </h1>
    </ng-template>
</div>

<app-footer></app-footer>